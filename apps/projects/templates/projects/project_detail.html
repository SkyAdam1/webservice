{% extends 'base_projects.html' %}
{% load static %}

{% block title %}
    {{ project.name }}
{% endblock title %}

{% block content %}

    <h1 class="mt-5">
        {{ project.name }}
    </h1>
    <h4>
        <p>{{ project.user }}</p>
    </h4>
    <h3>
        <a href='{{ item.project_site }}' >{{ project.site }}</a>
    </h3>
    <h4>
        <p>{{ project.description }}</p>
    </h4>
    <h4>
        <p>{{ project.note }}</p>
    </h4>
    <h4>
        {% if project.responsible %}
            <p> Ответственный: {{ project.responsible }}</p>
        {% else %}
            {% if request.user.is_staff %}

                <a href ="{% url 'project_add_responsible_url' project.id %}" class="btn mt-3" style="background-color: rgb(170, 170, 255);"> Назначить ответственного </a>

            {% else %}
                <p> Ответственный не указан </p>   
            {% endif %}
        {% endif %}
        {{ criteria_form.as_p }}
    </h4>
    <script>
        $(document).ready(function () {
            $('#id_science').change(function () {
                $.ajax({
                    data: {field: "science", user: {{ request.user.pk }}, project: {{ project.pk }}},
                    url: "{% url 'change_criteria' %}",
                    success: function (response) {}
                });
            });
            $('#id_interesting').change(function () {
                $.ajax({
                    data: {field: "interesting", user: {{ request.user.pk }}, project: {{ project.pk }}},
                    url: "{% url 'change_criteria' %}",
                    success: function (response) {}
                });
            });
            $('#id_difficult').change(function () {
                $.ajax({
                    data: {field: "difficult", user: {{ request.user.pk }}, project: {{ project.pk }}},
                    url: "{% url 'change_criteria' %}",
                    success: function (response) {}
                });
            });
            $('#id_unclear').change(function () {
                $.ajax({
                    data: {field: "unclear", user: {{ request.user.pk }}, project: {{ project.pk }}},
                    url: "{% url 'change_criteria' %}",
                    success: function (response) {}
                });
            });
            $('#id_repeat').change(function () {
                $.ajax({
                    data: {field: "repeat", user: {{ request.user.pk }}, project: {{ project.pk }}},
                    url: "{% url 'change_criteria' %}",
                    success: function (response) {}
                });
            });
        })
    </script>
{% endblock content %}